# Orders API service
    
## To compile and load the json test data to DB

$ mvn clean package

  this will run the test and load the src\test\data\data.json into database if table items is not empty

- after compile, we can also run the test directly to load the data into database:

  $ mvn -Dtest=OrderRepositoryTest#loadJsonToDB test

## To Start the API service     
$ java -jar target/orders-0.0.1-SNAPSHOT.jar

	then you can access the swagger-ui:
	http://localhost:8080/orders/swagger-ui/

## DB schema
    create.sql : auto-generated by setting JPA configuration properties

    create table items (
       order_number bigint not null auto_increment,
        customer_name varchar(50) not null,
        due_date date not null,
        order_type varchar(255),
        primary key (order_number)
    ) engine=InnoDB;
    
## The orders API service provides 2 REST APIs

- List of all orders by order type and/or due date
	e.g.
	curl -X GET "http://localhost:8080/orders/v1/orders" -H "accept: application/json"
	
	curl -X GET "http://localhost:8080/orders/v1/orders?duedate=2022-10-12" -H "accept: application/json"
	
	curl -X GET "http://localhost:8080/orders/v1/orders?type=TV" -H "accept: application/json"
	
	curl -X GET "http://localhost:8080/orders/v1/orders?duedate=2022-10-12&type=TV" -H "accept: application/json"

- Create new order:
	json body sample:
		{
		  "customerName": "joe",
		  "dueDate": "2022-11-20",
		  "orderType": "BUNDLE"
		}
		
	e.g.
	curl -X POST "http://localhost:8080/orders/v1/orders" -H "accept: application/json" -H "Content-Type: application/json" -d "{ \"customerName\": \"joe\", \"dueDate\": \"2022-11-20\", \"orderType\": \"BUNDLE\"}"

## Running on Docker

- Build orders serivce and load MySql to Docker image
	$ mvn clean package -DskipTests
	
	$ docker-compose -f ./docker-compose.yml up -d
		;then go to http://localhost:8080/orders/swagger-ui/ which has links for all the APIs
		   
	$ docker-compose -f ./docker-compose.yml down

- build orders serivce seperately
	$ docker build -t zmg9046/orders:tag-1.0.0 -f Dockerfile .
	$ docker run -p 8080:8080 --name orders -d zmg9046/orders:tag-1.0.0
